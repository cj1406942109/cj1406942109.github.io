# 20160826--Friday

### 工作内容
    
#### **农作物专项网站静态页面**
1. 完成度：50%
2. 说明：UI给出切图，按照切图完成页面
3. 详细信息：
    - 完成登录，首页和公告详情页面
    - UI给出切图和标注不完整，自行适当添加标注
    
----------------------


### 问题

#### **click相关事件触发顺序**

需求：
1. 在input输入框中添加一个清除按钮，点击清除按钮可以清除该输入框中已输入的内容。
2. 点击清除按钮后，焦点还是处于当前输入框上。 
3. 有多个输入框，只有当输入框被点击获取到焦点时才显示对应的清除按钮，输入框失去焦点时隐藏清除按钮。

实现：
1. 默认不显示清除按钮，即设置css样式`display:none`
2. 输入框（input）绑定`focus`和`blur`事件，得到焦点时，显示对应清除按钮，失去焦点时，隐藏对应按钮
3. 清除按钮绑定点击事件，用于清除输入框中的内容

问题：
1. 输入框获取到焦点后，显示了清除按钮，此时，点击清除按钮，绑定的点击事件没有触发，清除按钮便被隐藏。
2. 点击清除按钮的时，输入框失去焦点，只有再次点击输入框才能获取焦点。

解决方法：
1. 经查阅资料和验证，发现相关的事件触发顺序如下：
    > `mousedown`>`blur`>`mouseup`>`click`
2. 因此，以上问题的出现原因为，`blur`事件先于`click`事件发生，而`blur`事件的绑定函数使得`click`事件无法触发
3. 解决方法：将绑定在`click`事件的处理函数绑定到`mousedown`函数，并同时阻止`blur`事件触发

代码实现：
```js
    $('#form').find('input').on('focus',function () {
        //此处用于设置显示清除按钮
       $("#clearBtn").show();
    });
    $('.#form').find('input').on('blur',function () {
        //此处用于设置隐藏清除按钮
        $("#clearBtn").hide();
    });

    /*注意事件的触发顺序  mousedown>blur>mouseup>click*/
    $('.#clearBtn').on('mousedown',function (e) {
        //清除按钮与输入框为兄弟元素
        $(this).parent().find('input').val("");
        /*阻止blur事件的发生*/
        e.preventDefault();
    });
```
