# 音视频格式
> 记录时间：2018-03-28

## 视频和音频有不同的格式：
- WebM容器通常包括了Ogg Vorbis音频和VP8/VP9视频，主要在FireFox和Chrome中支持。
- MP4容器通常包括了AAC以及MP3音频和H.264视频，主要在Internet Explorer和Safari中支持。
- *老式的Ogg容器支持Ogg Vorbis音频和Ogg Theora视频，主要在FireFox和Chrome中支持，不过这个容器已经被更强大的WebM容器所取代。*

> [音视频元素浏览器兼容表](https://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats#Browser_compatibility)

## 为了兼容不同的浏览器，我们需要准备不同的音视频格式。
```html
<!-- 只有一种格式，不能兼容Safari或Internet Explorer -->
<video src="rabbit320.webm" controls>
  <p>Your browser doesn't support HTML5 video. Here is a <a href="rabbit320.webm">link to the video</a> instead.</p> 
</video>

<!-- 使用多种格式的文件 -->
<video controls>
  <source src="rabbit320.mp4" type="video/mp4">
  <source src="rabbit320.webm" type="video/webm">
  <p>Your browser doesn't support HTML5 video. Here is a <a href="rabbit320.mp4">link to the video</a> instead.</p>
</video>
```
> 将`src`属性移除，将其放在单独的`source`标签中，浏览器会检查`<source>`标签，并且播放第一个与其自身codec相匹配的媒体。

> **应包括WebM和MP4两种格式，目前已经足够支持大多数平台和浏览器**

> 每个`<source>`标签有一个`type`属性，它包含了视频文件的MIME types，同时浏览器会通过检查该属性来迅速跳过不支持的格式，该属性可选，但是如果没有添加type属性，浏览器会尝试加载每一个文件，直到找到一个能正确播放的格式，这会消耗大量的时间和资源。

> `<video>`标签的`poster`属性，指向一个吐信的URL，该图象会在视频播放前显示，通常用于粗略的预览或者广告显示。如果使用`autoplay`属性，当页面一加载就开始播放视频的话，就不会看到 poster 属性的效果了。

## 显示音轨文件
WebVTT格式，通过`<track>`标签使用：
```html
<video controls>
    <source src="example.mp4" type="video/mp4">
    <source src="example.webm" type="video/webm">
    <track kind="subtitles" src="subtitles_en.vtt" srclang="en">
</video>
```
使用方法：
1. 编辑WebVTT文件，并以.vtt后缀名保存
```vtt
WEBVTT

1
00:00:22.230 --> 00:00:24.606
This is the first subtitle.

2
00:00:30.739 --> 00:00:34.074
This is the second.

  ...
```
2. 用`<track>`标签链接.vtt文件，`<track>`标签需放在`<audio>`或`<video>`标签中，同时放在所有`<source>`标签之后。使用`kind`属性来指明是哪一种类型，如subtitles 、 captions 、 descriptions。然后使用`srclang`属性来告诉浏览器所使用的语言。

## 音视频格式转换软件
- [Miro Video Converter](http://www.mirovideoconverter.com/)
- [Audacity](https://sourceforge.net/projects/audacity/)