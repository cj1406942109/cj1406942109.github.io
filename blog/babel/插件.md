# 插件
> 记录时间：2018-10-31

Babel是一个编译器(源代码=>输出代码)。与许多其他编译器一样，它运行在三个阶段:解析、转换和输出。

你需要为Babel添加插件已完成这些过程。

Babel插件分为转换插件和语法插件。

## 转换插件
这些插件将转换应用到代码中。

转换插件将启用相应的语法插件，因此你不必同时指定这两个插件。

### ES3

- [member-expression-literals](https://babeljs.io/docs/en/babel-plugin-transform-member-expression-literals)
- [property-literals](https://babeljs.io/docs/en/babel-plugin-transform-property-literals)
- [reserved-words](https://babeljs.io/docs/en/babel-plugin-transform-reserved-words)

### ES5

- [property-mutators](https://babeljs.io/docs/en/babel-plugin-transform-property-mutators)

### ES2015

- [arrow-functions](https://babeljs.io/docs/en/babel-plugin-transform-arrow-functions)
- [block-scoped-functions](https://babeljs.io/docs/en/babel-plugin-transform-block-scoped-functions)
- [block-scoping](https://babeljs.io/docs/en/babel-plugin-transform-block-scoping)
- [classes](https://babeljs.io/docs/en/babel-plugin-transform-classes)
- [computed-properties](https://babeljs.io/docs/en/babel-plugin-transform-computed-properties)
- [destructuring](https://babeljs.io/docs/en/babel-plugin-transform-destructuring)
- [duplicate-keys](https://babeljs.io/docs/en/babel-plugin-transform-duplicate-keys)
- [for-of](https://babeljs.io/docs/en/babel-plugin-transform-for-of)
- [function-name](https://babeljs.io/docs/en/babel-plugin-transform-function-name)
- [instanceof](https://babeljs.io/docs/en/babel-plugin-transform-instanceof)
- [literals](https://babeljs.io/docs/en/babel-plugin-transform-literals)
- [new-target](https://babeljs.io/docs/en/babel-plugin-transform-new-target)
- [object-super](https://babeljs.io/docs/en/babel-plugin-transform-object-super)
- [parameters](https://babeljs.io/docs/en/babel-plugin-transform-parameters)
- [shorthand-properties](https://babeljs.io/docs/en/babel-plugin-transform-shorthand-properties)
- [spread](https://babeljs.io/docs/en/babel-plugin-transform-spread)
- [sticky-regex](https://babeljs.io/docs/en/babel-plugin-transform-sticky-regex)
- [template-literals](https://babeljs.io/docs/en/babel-plugin-transform-template-literals)
- [typeof-symbol](https://babeljs.io/docs/en/babel-plugin-transform-typeof-symbol)
- [unicode-regex](https://babeljs.io/docs/en/babel-plugin-transform-unicode-regex)


### ES2016

- [exponentiation-operator](https://babeljs.io/docs/en/babel-plugin-transform-exponentiation-operator)

### ES2017

- [async-to-generator](https://babeljs.io/docs/en/babel-plugin-transform-async-to-generator)

### ES2018

- [async-generator-functions](https://babeljs.io/docs/en/babel-plugin-proposal-async-generator-functions)
- [dotall-regex](https://babeljs.io/docs/en/babel-plugin-transform-dotall-regex)
- [object-rest-spread](https://babeljs.io/docs/en/babel-plugin-proposal-object-rest-spread)
- [optional-catch-binding](https://babeljs.io/docs/en/babel-plugin-proposal-optional-catch-binding)
- [unicode-property-regex](https://babeljs.io/docs/en/babel-plugin-proposal-unicode-property-regex)

### Modules
- [modules-amd](https://babeljs.io/docs/en/babel-plugin-transform-modules-amd)
- [modules-commonjs](https://babeljs.io/docs/en/babel-plugin-transform-modules-commonjs)
- [modules-systemjs](https://babeljs.io/docs/en/babel-plugin-transform-modules-systemjs)
- [modules-umd](https://babeljs.io/docs/en/babel-plugin-transform-modules-umd)

### Experimental
- [class-properties](https://babeljs.io/docs/en/babel-plugin-proposal-class-properties)
- [decorators](https://babeljs.io/docs/en/babel-plugin-proposal-decorators)
- [do-expressions](https://babeljs.io/docs/en/babel-plugin-proposal-do-expressions)
- [export-default-from](https://babeljs.io/docs/en/babel-plugin-proposal-export-default-from)
- [export-namespace-from](https://babeljs.io/docs/en/babel-plugin-proposal-export-namespace-from)
- [function-bind](https://babeljs.io/docs/en/babel-plugin-proposal-function-bind)
- [function-sent](https://babeljs.io/docs/en/babel-plugin-proposal-function-sent)
- [logical-assignment-operators](https://babeljs.io/docs/en/babel-plugin-proposal-logical-assignment-operators)
- [nullish-coalescing-operator](https://babeljs.io/docs/en/babel-plugin-proposal-nullish-coalescing-operator)
- [numeric-separator](https://babeljs.io/docs/en/babel-plugin-proposal-numeric-separator)
- [optional-chaining](https://babeljs.io/docs/en/babel-plugin-proposal-optional-chaining)
- [pipeline-operator](https://babeljs.io/docs/en/babel-plugin-proposal-pipeline-operator)
- [throw-expressions](https://babeljs.io/docs/en/babel-plugin-proposal-throw-expressions)

### Minification

查看[minifier based on Babel](https://github.com/babel/minify)。
以下是minify 仓库中的插件：

- [inline-consecutive-adds](https://babeljs.io/docs/en/babel-plugin-transform-inline-consecutive-adds)
- [inline-environment-variables](https://babeljs.io/docs/en/babel-plugin-transform-inline-environment-variables)
- [member-expression-literals](https://babeljs.io/docs/en/babel-plugin-transform-member-expression-literals)
- [merge-sibling-variables](https://babeljs.io/docs/en/babel-plugin-transform-merge-sibling-variables)
- [minify-booleans](https://babeljs.io/docs/en/babel-plugin-transform-minify-booleans)
- [minify-builtins](https://babeljs.io/docs/en/babel-plugin-minify-builtins)
- [minify-constant-folding](https://babeljs.io/docs/en/babel-plugin-minify-constant-folding)
- [minify-dead-code-elimination](https://babeljs.io/docs/en/babel-plugin-minify-dead-code-elimination)
- [minify-flip-comparisons](https://babeljs.io/docs/en/babel-plugin-minify-flip-comparisons)
- [minify-guarded-expressions](https://babeljs.io/docs/en/babel-plugin-minify-guarded-expressions)
- [minify-infinity](https://babeljs.io/docs/en/babel-plugin-minify-infinity)
- [minify-mangle-names](https://babeljs.io/docs/en/babel-plugin-minify-mangle-names)
- [minify-numeric-literals](https://babeljs.io/docs/en/babel-plugin-minify-numeric-literals)
- [minify-replace](https://babeljs.io/docs/en/babel-plugin-minify-replace)
- [minify-simplify](https://babeljs.io/docs/en/babel-plugin-minify-simplify)
- [minify-type-constructors](https://babeljs.io/docs/en/babel-plugin-minify-type-constructors)
- [node-env-inline](https://babeljs.io/docs/en/babel-plugin-transform-node-env-inline)
- [property-literals](https://babeljs.io/docs/en/babel-plugin-transform-property-literals)
- [regexp-constructors](https://babeljs.io/docs/en/babel-plugin-transform-regexp-constructors)
- [remove-console](https://babeljs.io/docs/en/babel-plugin-transform-remove-console)
- [remove-debugger](https://babeljs.io/docs/en/babel-plugin-transform-remove-debugger)
- [remove-undefined](https://babeljs.io/docs/en/babel-plugin-transform-remove-undefined)
- [simplify-comparison-operators](https://babeljs.io/docs/en/babel-plugin-transform-simplify-comparison-operators)
- [undefined-to-void](https://babeljs.io/docs/en/babel-plugin-transform-undefined-to-void)

### React
- [react-constant-elements](https://babeljs.io/docs/en/babel-plugin-transform-react-constant-elements)
- [react-display-name](https://babeljs.io/docs/en/babel-plugin-transform-react-display-name)
- [react-inline-elements](https://babeljs.io/docs/en/babel-plugin-transform-react-inline-elements)
- [react-jsx](https://babeljs.io/docs/en/babel-plugin-transform-react-jsx)
- [react-jsx-compat](https://babeljs.io/docs/en/babel-plugin-transform-react-jsx-compat)
- [react-jsx-self](https://babeljs.io/docs/en/babel-plugin-transform-react-jsx-self)
- [react-jsx-source](https://babeljs.io/docs/en/babel-plugin-transform-react-jsx-source)

### Other
- [external-helpers](https://babeljs.io/docs/en/babel-plugin-external-helpers)
- [flow-strip-types](https://babeljs.io/docs/en/babel-plugin-transform-flow-strip-types)
- [jscript](https://babeljs.io/docs/en/babel-plugin-transform-jscript)
- [object-assign](https://babeljs.io/docs/en/babel-plugin-transform-object-assign)
- [object-set-prototype-of-to-assign](https://babeljs.io/docs/en/babel-plugin-transform-object-set-prototype-of-to-assign)
- [proto-to-assign](https://babeljs.io/docs/en/babel-plugin-transform-proto-to-assign)
- [regenerator](https://babeljs.io/docs/en/babel-plugin-transform-regenerator)
- [runtime](https://babeljs.io/docs/en/babel-plugin-transform-runtime)
- [strict-mode](https://babeljs.io/docs/en/babel-plugin-transform-strict-mode)

## 语法插件

这些插件只允许Babel解析特定类型的语法(不做转换)。

> **注意:** 转换插件自动启用语法插件。因此，如果已经使用了相应的转换插件，就不需要指定语法插件。

`.bablerc`：
```json
{
  "parserOpts": {
    "plugins": ["jsx", "flow"]
  }
}
```

## 插件路径

如果插件在npm中，可以直接使用插件的名字，babel会在`node_modules`中寻找安装的插件：
```json
{
  "plugins": ["babel-plugin-myPlugin"]
}
```

你也可以指定插件的相对路径或绝对路径：
```json
{
  "plugins": ["./node_modules/asdf/plugin"]
}
```

## 插件缩写

如果插件的名字前缀是`babel-plugin-`，你可以使用缩写：
```js
{
  "plugins": [
    "myPlugin",
    "babel-plugin-myPlugin" // equivalent
  ]
}
```

这对于作用域包同样有效：
```js
{
  "plugins": [
    "@org/babel-plugin-name",
    "@org/name" // equivalent
  ]
}
```

## 插件排序

对于插件中的每一个元素，排序是很重要的。

这意味着如果两个转换都访问“程序”节点，转换将以plugin或preset的顺序运行。

- plugin在preset之前运行
- plugin按从第一个到最后一个排序
- preset按相反的顺序，从最后一个到第一个

如：
```json
{
  "plugins": [
    "transform-decorators-legacy",
    "transform-class-properties"
  ]
}
```

会先执行`transform-decorators-legacy`然后执行`transform-class-properties`。

而在`preset`中，这个顺序是相反的
```json
{
  "presets": [
    "es2015",
    "react",
    "stage-2"
  ]
}
```
会按`state-2`，`react`，`es2015`的顺序执行。

这主要是为确保向后兼容性,因为大多数用户在"state-0"之前列出"es2015"。
