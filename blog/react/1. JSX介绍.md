# JSX介绍
> 记录时间：2018-10-24

## 什么是JSX

```js
    const element = <h1>Hello, world!</h1>;
```

上面这段看起来既不是JavaScript字符串，也不是HTML的标签语法，就是JSX。

JSX是JavaScript的语法扩展（JavaScript Extension），在Recat中推荐使用这种语法，它虽然看起来像模板语言，但实际上完全由JavaScript实现。

## 为什么要使用JSX

React的思想将渲染逻辑与其他UI逻辑（诸如，事件是如何处理的，状态随时间如何变化，以及用于展示的数据如何准备）进行内部解耦。

相比于使用将标记和逻辑分别放在不同的文件的人工分离技术，React使用包含俩者的松耦合单元：“Components”，实现关注点分离。

虽然React可以不使用JSX，但是在JavaScript代码内部与UI打交道时，JSX是非常有用的。它能让Reaact显示更多有用的error和warning信息。

## 在JSX中嵌入表达式

```js
const name = 'Josh Perez';
const element = <h1>Hello, {name}</h1>;

ReactDOM.render(
  element,
  document.getElementById('root')
);
```
在JSX中，要使用表达式，将其使用花括号“{}”包裹即可。

下例，将JavaScript函数`formatName(user)`的调用结果嵌入到`<h1>`元素中。
```js
function formatName(user) {
  return user.firstName + ' ' + user.lastName;
}

const user = {
  firstName: 'Harper',
  lastName: 'Perez'
};

const element = (
  <h1>
    Hello, {formatName(user)}!
  </h1>
);

ReactDOM.render(
  element,
  document.getElementById('root')
);
```

## JSX本身也是一个表达式

在编译之后，JSX表达式变成普通的JavaScript函数调用和JavaScript对象的求值。

这意味着，你可以在`if`语句和`for`循环中使用JSX，将其赋值给变量、作为参数传递、或者作为函数的返回值。

```js
function getGreeting(user) {
  if (user) {
    return <h1>Hello, {formatName(user)}!</h1>;
  }
  return <h1>Hello, Stranger.</h1>;
}
```

## 在JSX中声明属性

你可以在JSX中使用引号来指定字符串值作为属性：
```js
const element = <div tabIndex="0"></div>;
```

也可以使用花括号将JavaScript表达式嵌入作为属性：
```js
const element = <img src={user.avatarUrl}></img>;
```

可以在添加属性的时候，使用引号（对于字符串）或者使用花括号（对于表达式），但是，对于同一个属性，不要同时使用引号和花括号。

> **注意：** 因为JSX相比于HTML更接近JavaScript，所以，React Dom，使用驼峰命名法对HTML属性进行命名。     
> 如：在JSX中，`class`用`className`表示，`tabindex`用`tabIndex`表示。

## 在JSX中声明子元素

对于空标签，可以像`XML`一样，直接用`/>`将其关闭。
```js
const element = <img src={user.avatarUrl} />;
```

同样，JSX也可以包含子元素：
```js
const element = (
  <div>
    <h1>Hello!</h1>
    <h2>Good to see you here.</h2>
  </div>
);
```

## JSX能够防止注入攻击

在JSX中，直接嵌入用户输入的内容是安全的。
```js
const title = response.potentiallyMaliciousInput;
// This is safe:
const element = <h1>{title}</h1>;
```
默认情况下，React Dom对嵌入JSX中的任何值，先进行转义操作，然后才将其渲染。这样能够确保你不能注入没有明确写在应用中任何内容。任何内容在被渲染之前，会被转成字符串，这样能够预防`XSS(cross-site-scripting)`攻击。

## JSX表示对象

Babel将JSX编译为`React.createElement()`调用，以下两种写法是等价的：
```js
const element = (
  <h1 className="greeting">
    Hello, world!
  </h1>
);
```

```js
const element = React.createElement(
  'h1',
  {className: 'greeting'},
  'Hello, world!'
);
```

`React.createElement()`会执行一些检查以减少你代码中的bug，其本质是创建了一个类似下面的对象：
```js
// Note: this structure is simplified
const element = {
  type: 'h1',
  props: {
    className: 'greeting',
    children: 'Hello, world!'
  }
};
```

这些对象叫做“React elements”，可以将其想象为你想要在屏幕上看到的内容的描述。React读取这些对象，使用它们来构建DOM并保持更新。

> 推荐在你的编辑器中使用[Babel language definition](https://babeljs.io/docs/en/editors/)，以高亮ES6和JSX代码。
