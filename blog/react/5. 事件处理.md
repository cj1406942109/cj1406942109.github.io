# 事件处理
> 记录时间：2018-10-24

React中的事件处理和DOM中的基本相同，只有一些语法差异：

- React中的事件使用驼峰命名法，而不是小写。
- 在JSX中，你需要传递一个函数而不是字符串作为事件处理器。

例如：在HTML中
```html
<button onclick="activateLasers()">
  Activate Lasers
</button>
```

在React中：
```js
<button onClick={activateLasers}>
  Activate Lasers
</button>
```

另一个不同点是，在React中，你不能通过返回`false`来阻止默认行为，你必须显式地调用`preventDefault`，如：为了防止点击链接之后打开新页面的默认行为，

在HTML中
```html
<a href="#" onclick="console.log('The link was clicked.'); return false">
  Click me
</a>
```

在React中
```js
function ActionLink() {
  function handleClick(e) {
    e.preventDefault();
    console.log('The link was clicked.');
  }

  return (
    <a href="#" onClick={handleClick}>
      Click me
    </a>
  );
}
```

这里的`e`是一个综合事件，React根据W3C规范定义这些综合事件，因此，你不需要担心跨浏览器的兼容性。

使用React时，你一般不需要在DOM元素创建之后，调用`addEventListener`来其添加监听器，只需要给最初渲染的元素提供一个监听器即可。

当使用ES6的class去定义一个组件时，最常用的模式就是，在class中定义一个方法用于事件处理。例如：
```js
class Toggle extends React.Component {
  constructor(props) {
    super(props);
    this.state = {isToggleOn: true};

    // This binding is necessary to make `this` work in the callback
    this.handleClick = this.handleClick.bind(this);
  }

  handleClick() {
    this.setState(state => ({
      isToggleOn: !state.isToggleOn
    }));
  }

  render() {
    return (
      <button onClick={this.handleClick}>
        {this.state.isToggleOn ? 'ON' : 'OFF'}
      </button>
    );
  }
}

ReactDOM.render(
  <Toggle />,
  document.getElementById('root')
);
```

在JavaScript中，类方法默认是没有绑定的，如果你忘了绑定`this.handleClick`就将其传递给`onClick`，`this`在实际调用时将会是`undefined`。

这不是React特定的行为，而是JavaScript中函数工作方式的一部分。一般情况下，如果你引用一个方法时不在后面加`()`，例如`onClick={this.handleClick}`，你应该绑定该方法。

如果你不想使用`bind`，还有一种方式，使用[public class fields syntax](https://babeljs.io/docs/plugins/transform-class-properties/)：
```js
class LoggingButton extends React.Component {
  // This syntax ensures `this` is bound within handleClick.
  // Warning: this is *experimental* syntax.
  handleClick = () => {
    console.log('this is:', this);
  }

  render() {
    return (
      <button onClick={this.handleClick}>
        Click me
      </button>
    );
  }
}
```

该语法在[创建React项目](https://github.com/facebook/create-react-app)中是默认启用的。

## 为事件处理函数传参

想要传递额外的参数给事件处理函数是很常见的，如：
```js
<button onClick={(e) => this.deleteRow(id, e)}>Delete Row</button>
<button onClick={this.deleteRow.bind(this, id)}>Delete Row</button>
```

以上两行是等价的，分别是使用箭头函数和`Function.prototype.bind`。

这两种情况下，`e`参数表示React事件，都会作为第二个参数传递。在箭头函数中， 我们需要显式传递，在`bind`中，任何深层的参数都会自动传递。
