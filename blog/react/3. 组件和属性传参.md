# 组件和属性传参
> 记录时间：2018-10-24

组件能够让你将UI分离为独立、可重用的小块，并且针对每个块单独考虑。

从概念上来看，组件和JavaScript中的函数类似。组件能够接受任意输入（称为“props”）并返回React元素。

## 函数和类组件

最简单的定义组件的方式就是写一个JavaScript函数：
```js
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}
```

也可以用ES6的`class`来定义组件：
```js
class Welcome extends React.Component {
  render() {
    return <h1>Hello, {this.props.name}</h1>;
  }
}
```

## 组件的渲染

React元素可以表示DOM标签：
```js
const element = <div />;
```
也可以表示用户自定义的组件：
```js
const element = <Welcome name="Sara" />;
```

当React遇到用户自定义的组件，它将JSX属性作为一个对象传递给这个组件，我们将其称为对象属性（object "props"）。

示例：
```js
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}

const element = <Welcome name="Sara" />;
ReactDOM.render(
  element,
  document.getElementById('root')
);
```

总结一下上例：

1. 我们对`<Welcome name="Sara" />`元素调用`ReactDOM.render()`方法
2. React调用`Welcome`组件，并使用`{name: 'Sara'}`作为属性传参
3. `Welcome`组件返回`<h1>Hello, Sara</h1>`元素作为结果
4. React DOM高效地更新DOM来匹配`<h1>Hello, Sara</h1>`

> **注意：** 组件名称首字母总是要大写。     
> 因为，React将名称小写的组件视为DOM标签。如，`<div />`表示一个HTML标签，而`<Welcome />`表示一个组件，并且需要`Welcome`在作用域内。


## 组件的组成

组件的输出可以引用其他组件。这让我们能够对任何细节级别使用相同的组件抽象，按钮、表单、对话框、屏幕，所有这些，在React应用中，通常都以组件来表示。

如：我们可以创建一个`App`组件对`Welcome`进行多次渲染
```js
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}

function App() {
  return (
    <div>
      <Welcome name="Sara" />
      <Welcome name="Cahal" />
      <Welcome name="Edite" />
    </div>
  );
}

ReactDOM.render(
  <App />,
  document.getElementById('root')
);
```

## 组件的提取

不要害怕将组件分割为更小的组件。

例如：
```js
function Comment(props) {
  return (
    <div className="Comment">
      <div className="UserInfo">
        <img className="Avatar"
          src={props.author.avatarUrl}
          alt={props.author.name}
        />
        <div className="UserInfo-name">
          {props.author.name}
        </div>
      </div>
      <div className="Comment-text">
        {props.text}
      </div>
      <div className="Comment-date">
        {formatDate(props.date)}
      </div>
    </div>
  );
}
```
上面的组件，接受`author`对象，`text`字符串和`date`日期对象作为“props”，用于描述社交媒体网站中的一个评论。

这个组件因为嵌套很难被改变，并且也很难复用其中的单件，因此，我们从中提取一些组件。

首先，我们提取`Avatar`：
```js
function Avatar(props) {
  return (
    <img className="Avatar"
      src={props.user.avatarUrl}
      alt={props.user.name}
    />

  );
}
```
因为`Avatar`不需要知道它是被渲染在`Comment`中， 所以，我们选择一个更通用的名字`user`作为它的属性。

> 建议属性的命名从组件本身出发，而不是去看组件应用的上下文。

简化之后的`Comment`：
```js
function Comment(props) {
  return (
    <div className="Comment">
      <div className="UserInfo">
        <Avatar user={props.author} />
        <div className="UserInfo-name">
          {props.author.name}
        </div>
      </div>
      <div className="Comment-text">
        {props.text}
      </div>
      <div className="Comment-date">
        {formatDate(props.date)}
      </div>
    </div>
  );
}
```

再提取一个`UserInfo`组件，用于渲染`Avatar`和后面的用户名：
```js
function UserInfo(props) {
  return (
    <div className="UserInfo">
      <Avatar user={props.user} />
      <div className="UserInfo-name">
        {props.user.name}
      </div>
    </div>
  );
}
```

再次简化`Comment`：
```js
function Comment(props) {
  return (
    <div className="Comment">
      <UserInfo user={props.author} />
      <div className="Comment-text">
        {props.text}
      </div>
      <div className="Comment-date">
        {formatDate(props.date)}
      </div>
    </div>
  );
}
```

## 属性（Props）是只读的

无论你是用函数还是用类的方式去定义一个组件，都不能改变它的props。

例如：
```js
function sum(a, b) {
  return a + b;
}
```
类似上面的`sum`函数，被称为“pure”，因为它们不尝试改变输入，并且给定相同的输入，总是返回相同的结果。

与之相对的，下面的函数就是“impure”，因为它改变了自己的输入：
```js
function withdraw(account, amount) {
  account.total -= amount;
}
```

React非常灵活，但是有一个严格的规则：   
**所有的React组件，必须像“pure”函数一样处理他们的“props”。**
