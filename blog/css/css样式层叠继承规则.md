# 样式层叠继承规则
> 记录时间：2018-08-13

## 层叠

CSS 是 Cascading Style Sheets 的缩写，这暗示层叠（cascade）的概念是很重要的。在最基本的层面上，它表明CSS规则的顺序很重要，但它比那更复杂。什么选择器在层叠中胜出取决于三个因素（这些都是按重量级顺序排列的——前面的的一种会否决后一种）：

- 重要性（Importance）
- 专用性（Specificity）
- 源代码次序（Source order）

### 重要性
在CSS中，有一个特别的语法可以让一条规则总是优先于其他规则：`!important`。

知道 !important存在是很有用的，这样当你在别人的代码中遇到它时，你就知道它是什么了。但是！我们建议你千万不要使用它，除非你绝对必须使用它。您可能不得不使用它的一种情况是，当您在CMS中工作时，您不能编辑核心的CSS模块，并且您确实想要重写一种不能以其他方式覆盖的样式。 但是，如果你能避免的话，不要使用它。由于 !important 改变了层叠正常工作的方式，因此调试CSS问题，尤其是在大型样式表中，会变得非常困难。

### 专用性

专用性基本上是衡量选择器的具体程度的一种方法——它能匹配多少元素。如上面所示的示例所示，元素选择器具有很低的专用性。类选择器具有更高的专用性，所以将战胜元素选择器。ID选择器有甚至更高的专用性, 所以将战胜类选择器. 战胜ID选择器的唯一方法是使用 `!important`。

一个选择器具有的专用性的量是用四种不同的值（或组件）来衡量的，它们可以被认为是千位，百位，十位和个位——在四个列中的四个简单数字：

- 千位：如果声明是在 `style` 属性中该列加1分（这样的声明没有选择器，所以它们的专用性总是1000。）否则为0。
- 百位：在整个选择器中每包含一个ID选择器就在该列中加1分。
- 十位：在整个选择器中每包含一个类选择器、属性选择器、或者伪类就在该列中加1分。
- 个位：在整个选择器中每包含一个元素选择器或伪元素就在该列中加1分。

> **注意：** 通用选择器 (`*`), 复合选择器 (`+`, `>`, `~`, ' ') 和否定伪类 (`:not`) 在专用性中无影响。

示例：
| 选择器 | 千位 | 百位 | 十位 | 个位 | 合计值 |
| --- | --- | --- | --- | --- | --- |
| h1 | 0 | 0 | 0 | 1 | 0001 |
| #indentifier | 0 | 1 | 0 | 0 | 0100 |
| h1 + p::first-letter | 0 | 0 | 0 | 3 | 0003 |
| li > a[href*="zh-CN"] > .inline-warning | 0 | 0 | 2 | 2 | 0022 |
| 没有选择器, 规则在一个元素的 `<style>` 属性里 | 1 | 0 | 0 | 0 | 1000 |

> **注意：** 如果多个选择器具有相同的重要性和专用性，则选择哪一个选择器取决于源码顺序。


### 源码顺序
如果多个相互竞争的选择器具有相同的重要性和专用性，那么第三个因素将帮助决定哪一个规则获胜——后面的规则将战胜先前的规则。例如:
```css
    p {
        color: blue;
    }

    /* This rule will win over the first one */
    p {
        color: red;
    }
```

### 规则混合的注意事项
在考虑所有这些层叠理论和什么样式优先于其他样式被应用时，你应该记住的一件事是，所有这些都发生在属性级别上——属性覆盖其他属性，但你不会让整个规则凌驾于其他规则之上。

也就是说，当多个CSS规则匹配相同的元素时，它们都被应用到该元素中。只有在这之后，任何相互冲突的属性才会使用以上的覆盖规则。

## 继承
CSS继承是我们需要研究的最后一部分，以获取所有信息并了解什么样式应用于元素。其思想是，应用于某个元素的一些属性值将由该元素的子元素继承，而有些则不会。

哪些属性默认被继承哪些不被继承大部分符合常识。如果你想确定，你可以参考[CSS参考资料](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference)—— 每个单独的属性页都会从一个汇总表开始，其中包含有关该元素的各种详细信息，包括是否被继承。

CSS为处理继承提供了四种特殊的通用属性值：

- `inherit：` 该值将应用到选定元素的属性值设置为与其父元素一样。
- `initial` ：该值将应用到选定元素的属性值设置为与浏览器默认样式表中该元素设置的值一样。如果浏览器默认样式表中没有设置值，并且该属性是自然继承的，那么该属性值就被设置为 `inherit`。
- `unset` ：该值将属性重置为其自然值，即如果属性是自然继承的，那么它就表现得像 `inherit`，否则就是表现得像 `initial`。
- `revert` ：如果当前的节点没有应用任何样式，则将该属性恢复到它所拥有的值。换句话说，属性值被设置成自定义样式所定义的属性（如果被设置）， 否则属性值被设置成用户代理的默认样式。

> **注意：** `initial` 和 `unset` 不被IE支持。

